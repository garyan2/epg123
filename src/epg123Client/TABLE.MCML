<Mcml xmlns="http://schemas.microsoft.com/2006/mcml" xmlns:cor="assembly://MSCorLib/System" xmlns:shell="assembly://Microsoft.MediaCenter.Shell/Microsoft.MediaCenter.Shell" xmlns:asr="res://Microsoft.MediaCenter.Shell!AutoScrollRegion.mcml" xmlns:turbo="res://Microsoft.MediaCenter.Shell!TurboScroll.mcml" xmlns:browseturbo="res://Microsoft.MediaCenter.Shell!BrowseTurbo.mcml" xmlns:me="Me"> <UI Name="Table"> <Properties> <shell:ITableModel Name="Model" ITableModel="$Required"/> <EditableText Name="FocusArea" Value="TableBody"/> <BooleanChoice Name="PanningTable"/> <cor:Int32 Name="VisibleRowCapacity" Int32="1"/> <cor:Int32 Name="FirstVisibleRow" Int32="0"/> <cor:Int32 Name="InitialFocusRow" Int32="0"/> <cor:Int32 Name="MinimumRow" Int32="0"/> <cor:Int32 Name="MaximumRow" Int32="1000"/> <cor:Single Name="FocusRowScale" Single="1.0"/> <cor:Int32 Name="RowScrollIncrement" Int32="1"/> <RepeatPolicy Name="RowRepeat" RepeatPolicy="Never"/> <cor:Boolean Name="CenterLockFocusRow" Boolean="false"/> <cor:Boolean Name="ConstantRowCount" Boolean="true"/> <cor:Int32 Name="VisibleColumnCapacity" Int32="1"/> <cor:Int32 Name="FirstVisibleColumn" Int32="0"/> <cor:Int32 Name="MinimumColumn" Int32="0"/> <cor:Int32 Name="MaximumColumn" Int32="1000"/> <cor:Single Name="FocusColumnScale" Single="1.0"/> <cor:Int32 Name="ColumnScrollIncrement" Int32="1"/> <RepeatPolicy Name="ColumnRepeat" RepeatPolicy="Never"/> <cor:Boolean Name="CenterLockFocusColumn" Boolean="false"/> <cor:Boolean Name="ConstantColumnCount" Boolean="true"/> <cor:Int32 Name="RowHeaderWidth" Int32="0"/> <cor:Int32 Name="ColumnHeaderHeight" Int32="0"/> <cor:String Name="DefaultColumnHeaderTemplate" String="$Required"/> <cor:String Name="DefaultRowHeaderTemplate" String="$Required"/> <cor:String Name="DefaultBodyTemplate" String="$Required"/> <cor:String Name="TurboForegroundTemplate" String="@res://Microsoft.MediaCenter.Shell!TurboScroll.mcml#Foreground"/> <shell:TurboScrollUtility Name="TurboUtility"/> <cor:String Name="CornerCellTemplate" String="$Required"/> </Properties> <Locals> <Environment Name="Environment"/> <shell:TableDataSet Name="BodySource"/> <shell:TableDataSet Name="RowHeaderSource" ColumnScrollData="-1,1,-1,-1"/> <shell:TableDataSet Name="ColumnHeaderSource" RowScrollData="-1,1,-1,-1"/> <Command Name="RowScrollUpCommand"/> <Command Name="RowScrollDownCommand"/> <Command Name="ColumnScrollUpCommand"/> <Command Name="ColumnScrollDownCommand"/> <Command Name="RowClickUpCommand"/> <Command Name="RowClickDownCommand"/> <Command Name="ColumnClickUpCommand"/> <Command Name="ColumnClickDownCommand"/> <cor:Int32 Name="RowHeaderColumn" Int32="-1"/> <cor:Int32 Name="ColumnHeaderRow" Int32="-1"/> <Command Name="TurboMouseForwardCommand"/> <Command Name="TurboMouseReverseCommand"/> <Command Name="TurboKeyForwardCommand"/> <Command Name="TurboKeyReverseCommand"/> <Command Name="TurboForwardCommand"/> <Command Name="TurboReverseCommand"/> <Command Name="TurboStopCommand"/> <Command Name="TurboStartCommand"/> <shell:TurboScrollDirection Name="TurboDirection" TurboScrollDirection="Forward"/> <shell:TurboScrollController Name="TurboController"/> <shell:TurboScrollKeyHandler Name="TurboReverseKey" Key="Left" Direction="Reverse" HandlerStage="Routed"/> <shell:TurboScrollKeyHandler Name="TurboForwardKey" Key="Right" Direction="Forward" HandlerStage="Routed"/> <BooleanChoice Name="TurboActive"/> <BooleanChoice Name="PanningBody"/> <BooleanChoice Name="PanningRowHeaders"/> <BooleanChoice Name="PanningColumnHeaders"/> <IntRangedValue Name="RowHeadersHeight"/> <IntRangedValue Name="ColumnHeadersWidth"/> <IntRangedValue Name="BodyHeight"/> <IntRangedValue Name="BodyWidth"/> <IntRangedValue Name="RatchetWidth"/> <IntRangedValue Name="RatchetHeight"/> </Locals> <Rules> <Binding Source="[TurboController]" Target="[TurboReverseKey.TurboController]"/> <Binding Source="[TurboKeyReverseCommand]" Target="[TurboReverseKey.StartCommand]"/> <Binding Source="[TurboStopCommand]" Target="[TurboReverseKey.StopCommand]"/> <Binding Source="[TurboController]" Target="[TurboForwardKey.TurboController]"/> <Binding Source="[TurboKeyForwardCommand]" Target="[TurboForwardKey.StartCommand]"/> <Binding Source="[TurboStopCommand]" Target="[TurboForwardKey.StopCommand]"/> <Rule> <Conditions> <Equality Source="[Environment.IsRightToLeft]" ConditionOp="Equals" Value="true"/> </Conditions> <Actions> <Set Target="[TurboReverseKey.Key]" Value="Right"/> <Set Target="[TurboForwardKey.Key]" Value="Left"/> </Actions> </Rule> <Binding Source="[TurboForegroundTemplate]" Target="[TurboForeground.Source]"/> <Binding Target="[BodySource.Source]" Source="[Model]"/> <Binding Target="[RowHeaderSource.Source]" Source="[Model]"/> <Binding Target="[ColumnHeaderSource.Source]" Source="[Model]"/> <Default Target="[RowHeaderSource.RowScrollData]" Value="[BodySource.RowScrollData]"/> <Default Target="[ColumnHeaderSource.ColumnScrollData]" Value="[BodySource.ColumnScrollData]"/> <Binding Source="[VisibleRowCapacity]" Target="[BodySource.RowScrollData.VisibleCapacity]"/> <Binding Source="[MinimumRow]" Target="[BodySource.RowScrollData.Minimum]"/> <Binding Source="[MaximumRow]" Target="[BodySource.RowScrollData.Maximum]"/> <Binding Source="[FocusRowScale]" Target="[BodySource.RowScrollData.FocusScale]"/> <Binding Source="[RowScrollIncrement]" Target="[BodySource.RowScrollData.ScrollIncrement]"/> <Binding Source="[RowRepeat]" Target="[BodySource.RowScrollData.Repeat]"/> <Default Value="[InitialFocusRow]" Target="[BodySource.RowScrollData.InitialFocus]"/> <Binding Source="[FirstVisibleRow]" Target="[BodySource.RowScrollData.InitialFirstVisible]"/> <Binding Source="[CenterLockFocusRow]" Target="[BodySource.RowScrollData.CenterLockFocus]"/> <Binding Source="[ConstantRowCount]" Target="[BodySource.RowScrollData.ConstantDataSize]"/> <Binding Source="[VisibleColumnCapacity]" Target="[BodySource.ColumnScrollData.VisibleCapacity]"/> <Binding Source="[MinimumColumn]" Target="[BodySource.ColumnScrollData.Minimum]"/> <Binding Source="[MaximumColumn]" Target="[BodySource.ColumnScrollData.Maximum]"/> <Binding Source="[FocusColumnScale]" Target="[BodySource.ColumnScrollData.FocusScale]"/> <Binding Source="[ColumnScrollIncrement]" Target="[BodySource.ColumnScrollData.ScrollIncrement]"/> <Binding Source="[ColumnRepeat]" Target="[BodySource.ColumnScrollData.Repeat]"/> <Binding Source="[FirstVisibleColumn]" Target="[BodySource.ColumnScrollData.FirstVisible]"/> <Binding Source="[CenterLockFocusColumn]" Target="[BodySource.ColumnScrollData.CenterLockFocus]"/> <Binding Source="[ConstantColumnCount]" Target="[BodySource.ColumnScrollData.ConstantDataSize]"/> <Default Value="[RowHeaderColumn]" Target="[RowHeaderSource.ColumnScrollData.Minimum]"/> <Default Value="[RowHeaderColumn]" Target="[RowHeaderSource.ColumnScrollData.FirstVisible]"/> <Default Value="[RowHeaderColumn]" Target="[RowHeaderSource.ColumnScrollData.Maximum]"/> <Binding Source="[ConstantRowCount]" Target="[RowHeaderSource.RowScrollData.ConstantDataSize]"/> <Default Value="true" Target="[RowHeaderSource.ColumnScrollData.ConstantDataSize]"/> <Default Value="[ColumnHeaderRow]" Target="[ColumnHeaderSource.RowScrollData.Minimum]"/> <Default Value="[ColumnHeaderRow]" Target="[ColumnHeaderSource.RowScrollData.FirstVisible]"/> <Default Value="[ColumnHeaderRow]" Target="[ColumnHeaderSource.RowScrollData.Maximum]"/> <Binding Source="[ConstantColumnCount]" Target="[ColumnHeaderSource.ColumnScrollData.ConstantDataSize]"/> <Default Value="true" Target="[ColumnHeaderSource.RowScrollData.ConstantDataSize]"/> <Condition Source="[Input.DeepKeyFocus]" ConditionOp="ChangedTo" SourceValue="true"> <Actions> <Invoke Target="[BodySource.UpdateKeyFocus]"/> </Actions> </Condition> <Condition Source="[Input.DeepKeyFocus]" ConditionOp="ChangedTo" SourceValue="false"> <Actions> <Set Target="[FocusArea.Value]" Value="OutsideTable"/> <Invoke Target="[BodySource.ColumnScrollData.MarkKeyUp]" key="Left"/> </Actions> </Condition> <Changed Source="[BodySource.FocusChanged]"> <Conditions> <Equality Source="[FocusArea.Value]" Value="TableBody"/> </Conditions> <Actions> <Invoke Target="[BodySource.UpdateKeyFocus]"/> </Actions> </Changed> <Changed Source="[RowHeaderSource.FocusChanged]"> <Conditions> <Equality Source="[FocusArea.Value]" Value="RowHeader"/> </Conditions> <Actions> <Invoke Target="[RowHeaderSource.UpdateKeyFocus]"/> </Actions> </Changed> <Changed Source="[ColumnHeaderSource.FocusChanged]"> <Conditions> <Equality Source="[FocusArea.Value]" Value="ColumnHeader"/> </Conditions> <Actions> <Invoke Target="[ColumnHeaderSource.UpdateKeyFocus]"/> </Actions> </Changed> <Condition Source="[Input.DeepKeyFocus]" SourceValue="true"> <Actions> <Set Target="[Down.Visible]" Value="true"/> <Set Target="[Up.Visible]" Value="true"/> </Actions> </Condition> <Condition Source="[Input.DeepKeyFocus]" SourceValue="true"> <Conditions> <Equality Source="[ColumnHeaders.Visible]" Value="true"/> </Conditions> <Actions> <Set Target="[Right.Visible]" Value="true"/> <Set Target="[Left.Visible]" Value="true"/> </Actions> </Condition> <Condition Source="[TurboController.Enabled]" ConditionOp="Equals" SourceValue="true"> <Actions> <Set Target="[Right.Visible]" Value="true"/> <Set Target="[Left.Visible]" Value="true"/> </Actions> </Condition> <Binding Source="[RowHeadersHeight.Value]" Target="[BodyHeight.Value]"/> <Binding Source="[BodyHeight.Value]" Target="[RowHeadersHeight.Value]"/> <Binding Source="[ColumnHeadersWidth.Value]" Target="[BodyWidth.Value]"/> <Binding Source="[BodyWidth.Value]" Target="[ColumnHeadersWidth.Value]"/> <Rule ConditionLogicalOp="Or"> <Conditions> <Equality Source="[PanningBody.Value]" Value="true"/> <Equality Source="[PanningRowHeaders.Value]" Value="true"/> <Equality Source="[PanningColumnHeaders.Value]" Value="true"/> </Conditions> <Actions> <Set Target="[PanningTable.Value]" Value="true"/> </Actions> </Rule> <Default Target="[PanningTable.Value]" Value="false"/> <Binding Source="[ColumnHeaderSource.RatchetValue]" Target="[RatchetWidth.Value]"/> <Binding Source="[RowHeaderSource.RatchetValue]" Target="[RatchetHeight.Value]"/> </Rules> <Content> <Panel Layout="Form"> <Children> <asr:TableAxisAutoScrollRegion Name="Up" ScrollData="[BodySource.RowScrollData]" ScrollCommand="[RowScrollUpCommand]" ClickCommand="[RowClickUpCommand]" LayoutPosition="Top" RestModeEnabled="true" NavigationHintMargins="10,3,10,18" Visible="false"> <LayoutInput> <FormLayoutInput Left="CornerPanel,1,20" Top="CornerPanel,1,-49" Bottom="CornerPanel,1,10" Right="Parent,1,-33"/> </LayoutInput> </asr:TableAxisAutoScrollRegion> <asr:TableAxisAutoScrollRegion Name="Down" ScrollData="[BodySource.RowScrollData]" ScrollCommand="[RowScrollDownCommand]" ClickCommand="[RowClickDownCommand]" LayoutPosition="Bottom" RestModeEnabled="true" NavigationHintMargins="10,14,10,7" Visible="false"> <LayoutInput> <FormLayoutInput Left="CornerPanel,1,20" Top="Parent,1,-10" Bottom="Parent,1,49" Right="Parent,1,-33"/> </LayoutInput> </asr:TableAxisAutoScrollRegion> <asr:TableAxisAutoScrollRegion Name="Left" ScrollData="[BodySource.ColumnScrollData]" ScrollCommand="[ColumnScrollUpCommand]" ClickCommand="[ColumnClickUpCommand]" LayoutPosition="Left" RestModeEnabled="true" NavigationHintMargins="5,10,5,10" Visible="false" TransitionActive="[TurboActive]" TransitionStartCommand="[TurboMouseReverseCommand]" TransitionStopCommand="[TurboStopCommand]"> <LayoutInput> <FormLayoutInput Left="CornerPanel,1,-28" Top="CornerPanel,1,10" Bottom="Parent,1,-10" Right="CornerPanel,1,20"/> </LayoutInput> </asr:TableAxisAutoScrollRegion> <asr:TableAxisAutoScrollRegion Name="Right" ScrollData="[BodySource.ColumnScrollData]" ScrollCommand="[ColumnScrollDownCommand]" ClickCommand="[ColumnClickDownCommand]" LayoutPosition="Right" RestModeEnabled="true" NavigationHintMargins="5,10,47,10" Visible="false" TransitionActive="[TurboActive]" TransitionStartCommand="[TurboMouseForwardCommand]" TransitionStopCommand="[TurboStopCommand]"> <LayoutInput> <FormLayoutInput Left="Parent,1,-33" Top="CornerPanel,1,10" Bottom="Parent,1,-10" Right="Parent,1,56"/> </LayoutInput> </asr:TableAxisAutoScrollRegion> <turbo:Foreground Name="TurboForeground" TurboController="[TurboController]" Visible="false"> <LayoutInput> <FormLayoutInput Left="CornerPanel,1,-20" Top="CornerPanel,1" Right="Parent,1,20" Bottom="Parent,1,100"/> </LayoutInput> </turbo:Foreground> <me:TableRegion Name="RowHeaders" DataSource="[RowHeaderSource]" DefaultTemplate="[DefaultRowHeaderTemplate]" FocusArea="[FocusArea]" Area="RowHeader" PanHeight="[RowHeadersHeight]" PanAxis="Y" IsPanning="[PanningRowHeaders]" PanningTable="[PanningTable]" RatchetWidth="[RatchetWidth]" RatchetHeight="[RatchetHeight]"> <LayoutInput> <FormLayoutInput Left="CornerPanel,0" Top="CornerPanel,1" Right="CornerPanel,1" Bottom="Parent,1"/> </LayoutInput> </me:TableRegion> <me:TableRegion Name="Body" DataSource="[BodySource]" DefaultTemplate="[DefaultBodyTemplate]" FocusArea="[FocusArea]" Area="TableBody" PanWidth="[BodyWidth]" PanHeight="[BodyHeight]" PanAxis="Dominant" IsPanning="[PanningBody]" PanningTable="[PanningTable]" RatchetWidth="[RatchetWidth]" RatchetHeight="[RatchetHeight]"> <LayoutInput> <FormLayoutInput Left="CornerPanel,1" Top="CornerPanel,1" Right="Parent,1" Bottom="Parent,1"/> </LayoutInput> </me:TableRegion> <me:BaseCornerTableCell Name="CornerPanel" Model="[BodySource]" Source="[CornerCellTemplate]"> <MinimumSize> <Size Width="[RowHeaderWidth]" Height="[ColumnHeaderHeight]"/> </MinimumSize> <MaximumSize> <Size Width="[RowHeaderWidth]" Height="[ColumnHeaderHeight]"/> </MaximumSize> <LayoutInput> <FormLayoutInput Left="Parent,0" Top="Parent,0"/> </LayoutInput> </me:BaseCornerTableCell> <me:TableRegion Name="ColumnHeaders" DataSource="[ColumnHeaderSource]" DefaultTemplate="[DefaultColumnHeaderTemplate]" FocusArea="[FocusArea]" Area="ColumnHeader" PanWidth="[ColumnHeadersWidth]" PanAxis="X" IsPanning="[PanningColumnHeaders]" PanningTable="[PanningTable]" RatchetWidth="[RatchetWidth]" RatchetHeight="[RatchetHeight]"> <LayoutInput> <FormLayoutInput Left="CornerPanel,1" Top="Parent,0" Right="Parent,1" Bottom="CornerPanel,1"/> </LayoutInput> </me:TableRegion> </Children> </Panel> </Content> </UI> <UI Name="TableRegion"> <Properties> <shell:TableDataSet Name="DataSource" TableDataSet="$Required"/> <cor:String Name="DefaultTemplate" String="@res://Microsoft.MediaCenter.Shell!Table.mcml#BaseTableCell"/> <EditableText Name="FocusArea" EditableText="$Required"/> <cor:String Name="Area" String="$Required"/> <GesturePanLockAxis Name="PanAxis"/> <IntRangedValue Name="PanWidth"/> <IntRangedValue Name="PanHeight"/> <IntRangedValue Name="RatchetWidth"/> <IntRangedValue Name="RatchetHeight"/> <Size Name="RatchetSize"/> <Size Name="AutoRatchetSize"/> <BooleanChoice Name="IsPanning"/> <BooleanChoice Name="PanningTable"/> </Properties> <Locals> <GesturePanHandler Name="GesturePanHandler" PanLockAxis="[PanAxis]" HandlerStage="Bubbled"/> <GestureRatchetSettings Name="RatchetSettings"/> <FormLayoutInput Name="RepeaterLayout" Left="Parent,0" Top="Parent,0" Bottom="Parent,1" Right="Parent,1" ContributesToWidth="false" ContributesToHeight="false"/> </Locals> <Rules> <Default Target="[DataSource.Repeater]" Value="[CellRepeater]"/> <Binding Target="[CellRepeater.Source]" Source="[DataSource]"/> <Default Target="[GesturePanHandler.RatchetSettings]" Value="[RatchetSettings]"/> <Binding Target="[RatchetSize.Width]" Source="[RatchetWidth.Value]"> <Transformer> <MathTransformer SubtractInt="2"/> </Transformer> </Binding> <Binding Target="[RatchetSize.Height]" Source="[RatchetHeight.Value]"> <Transformer> <MathTransformer SubtractInt="2"/> </Transformer> </Binding> <Binding Target="[AutoRatchetSize.Width]" Source="[RatchetWidth.Value]"> <Transformer> <MathTransformer DivideInt="3"/> </Transformer> </Binding> <Binding Target="[AutoRatchetSize.Height]" Source="[RatchetHeight.Value]"> <Transformer> <MathTransformer DivideInt="3"/> </Transformer> </Binding> <Rule ConditionLogicalOp="Or"> <Conditions> <Modified Source="[RatchetHeight.Value]"/> <Modified Source="[RatchetWidth.Value]"/> </Conditions> <Actions> <Set Target="[RatchetSettings.RatchetSize]" Value="[RatchetSize]"/> <Set Target="[RatchetSettings.AutoRatchetSize]" Value="[AutoRatchetSize]"/> </Actions> </Rule> <Rule> <Conditions> <Equality Source="[IsPanning.Value]" Value="false"/> <Equality Source="[GesturePanHandler.IsPanning]" Value="true"/> <Equality Source="[PanningTable.Value]" Value="false"/> <Equality Source="[GesturePanHandler.CalculatedPanLockAxis]" Value="Y"/> <Equality Source="[DataSource.RowScrollData.VisibleCount]" ConditionOp="LessThanOrEquals" Value="[DataSource.RowScrollData.Maximum]"/> </Conditions> <Actions> <Set Target="[IsPanning.Value]" Value="true"/> </Actions> </Rule> <Rule> <Conditions> <Equality Source="[IsPanning.Value]" Value="false"/> <Equality Source="[GesturePanHandler.IsPanning]" Value="true"/> <Equality Source="[PanningTable.Value]" Value="false"/> <Equality Source="[GesturePanHandler.CalculatedPanLockAxis]" Value="X"/> </Conditions> <Actions> <Set Target="[IsPanning.Value]" Value="true"/> </Actions> </Rule> <Rule> <Conditions> <Equality Source="[IsPanning.Value]" Value="true"/> <Equality Source="[GesturePanHandler.IsPanning]" Value="true"/> </Conditions> <Actions> <Set Target="[IsPanning.Value]" Value="true"/> </Actions> </Rule> <Condition Source="[GesturePanHandler.IsPanningInertia]" ConditionOp="ChangedTo" SourceValue="false"> <Actions> <Invoke Target="[DataSource.UpdateKeyFocus]"/> </Actions> </Condition> <Changed Source="[GesturePanHandler.RatchetOffset]"> <Conditions> <Equality Source="[IsPanning.Value]" Value="true"/> </Conditions> <Actions> <Set Target="[PanHeight.Value]" Value="[GesturePanHandler.RatchetOffset.Height]"/> <Set Target="[PanWidth.Value]" Value="[GesturePanHandler.RatchetOffset.Width]"/> </Actions> </Changed> <Changed Source="[PanHeight.Value]"> <Actions> <Set Target="[RepeaterLayout.Top.Offset]" Value="[PanHeight.Value]"/> <Set Target="[RepeaterLayout.Bottom.Offset]" Value="[PanHeight.Value]"/> <Invoke Target="[CellRepeater.MarkLayoutInvalid]" InvokePolicy="Synchronous"/> </Actions> </Changed> <Changed Source="[PanWidth.Value]"> <Actions> <Set Target="[RepeaterLayout.Right.Offset]" Value="[PanWidth.Value]"/> <Set Target="[RepeaterLayout.Left.Offset]" Value="[PanWidth.Value]"/> <Invoke Target="[CellRepeater.MarkLayoutInvalid]" InvokePolicy="Synchronous"/> </Actions> </Changed> <Rule> <Conditions> <Equality Source="[PanAxis]" ConditionOp="NotEquals" Value="Y"/> <Equality Source="[PanWidth.Value]" ConditionOp="GreaterThan" Value="0"/> <Equality Source="[DataSource.ColumnScrollData.CanScrollUp]" Value="false"/> </Conditions> <Actions> <Set Target="[GesturePanHandler.ElasticityLeft]" Value="0.85"/> </Actions> </Rule> <Default Target="[GesturePanHandler.ElasticityLeft]" Value="0.0"/> <Rule> <Conditions> <Equality Source="[PanAxis]" ConditionOp="NotEquals" Value="Y"/> <Equality Source="[PanWidth.Value]" ConditionOp="LessThan" Value="0"/> <Equality Source="[DataSource.ColumnScrollData.CanScrollDown]" Value="false"/> </Conditions> <Actions> <Set Target="[GesturePanHandler.ElasticityRight]" Value="0.85"/> </Actions> </Rule> <Default Target="[GesturePanHandler.ElasticityRight]" Value="0.0"/> <Changed Source="[GesturePanHandler.RatchetUp]"> <Conditions> <Equality Source="[IsPanning.Value]" Value="true"/> </Conditions> <Actions> <Set Target="[DataSource.RowScrollData.FirstVisible]" Value="[DataSource.RowScrollData.FirstVisible]"> <Transformer> <MathTransformer SubtractInt="1"/> </Transformer> </Set> </Actions> </Changed> <Changed Source="[GesturePanHandler.RatchetDown]"> <Conditions> <Equality Source="[IsPanning.Value]" Value="true"/> </Conditions> <Actions> <Set Target="[DataSource.RowScrollData.FirstVisible]" Value="[DataSource.RowScrollData.FirstVisible]"> <Transformer> <MathTransformer AddInt="1"/> </Transformer> </Set> </Actions> </Changed> <Changed Source="[GesturePanHandler.RatchetLeft]"> <Conditions> <Equality Source="[IsPanning.Value]" Value="true"/> </Conditions> <Actions> <Set Target="[DataSource.ColumnScrollData.FirstVisible]" Value="[DataSource.ColumnScrollData.FirstVisible]"> <Transformer> <MathTransformer SubtractInt="30"/> </Transformer> </Set> </Actions> </Changed> <Changed Source="[GesturePanHandler.RatchetRight]"> <Conditions> <Equality Source="[IsPanning.Value]" Value="true"/> </Conditions> <Actions> <Set Target="[DataSource.ColumnScrollData.FirstVisible]" Value="[DataSource.ColumnScrollData.FirstVisible]"> <Transformer> <MathTransformer AddInt="30"/> </Transformer> </Set> </Actions> </Changed> <Default Target="[IsPanning.Value]" Value="false"/> </Rules> <Content> <Clip Name="Root" Orientation="Vertical" FadeSize="1"> <Children> <Clip Orientation="Horizontal" FadeSize="1" Layout="Form"> <Children> <Repeater Name="CellRepeater" Layout="Form" DiscardOffscreenVisuals="true" RepairFocusOnContentChange="false" LayoutInput="[RepeaterLayout]"> <Content> <me:TableCellHost DefaultTemplate="[DefaultTemplate]" Model="[RepeatedItem!shell:TableListItem]" FocusArea="[FocusArea]" Area="[Area]" PanWidth="[PanWidth]" IsPanning="[PanningTable]"/> </Content> </Repeater> </Children> </Clip> </Children> </Clip> </Content> </UI> <UI Name="BaseTableCell"> <Properties> <shell:TableListItem Name="Model" TableListItem="$Required"/> <EditableText Name="FocusArea" EditableText="$Required"/> <cor:String Name="Area" String="$Required"/> <IntRangedValue Name="PanWidth"/> <BooleanChoice Name="InToss"/> <BooleanChoice Name="IsPanning"/> </Properties> </UI> <UI Name="BaseCornerTableCell"> <Properties> <shell:TableDataSet Name="Model" TableDataSet="$Required"/> <BooleanChoice Name="ShowDate" Value="true"/> </Properties> </UI> <UI Name="TableCellHost" BaseUI="me:BaseTableCell"> <Properties> <cor:String Name="DefaultTemplate" String="$Required"/> </Properties> <Rules> <Condition Source="[Model.Cell.Template]" ConditionOp="NotEquals" SourceValue="null" Target="[Host.Source]" Value="[Model.Cell.Template]"/> <Default Target="[Host.Source]" Value="[DefaultTemplate]"/> </Rules> <Content> <me:BaseTableCell Name="Host" Model="[Model]" FocusArea="[FocusArea]" Area="[Area]" PanWidth="[PanWidth]" InToss="[InToss]" IsPanning="[IsPanning]"/> </Content> </UI> <UI Name="TableCell" BaseUI="me:BaseTableCell"> <Locals> <shell:TableItemKeyHandler Name="KeyHandler" Model="[Model]" HandlerStage="Bubbled"/> <MouseWheelHandler Name="WheelHandler" HandlerStage="Routed"/> <cor:Int32 Name="RowHeaderColumn" Int32="-1"/> <cor:Int32 Name="ColumnHeaderRow" Int32="-1"/> <cor:Int32 Name="InitialOffset" Int32="[Model.LayoutInput!AnchorLayoutInput.Left.Offset]"/> <MathTransformer Name="Subtracter" Absolute="false"/> <MathTransformer Name="Adder" Absolute="false"/> </Locals> <Rules> <Binding Target="[Subtracter.SubtractInt]" Source="[PanWidth.Value]"> <Transformer> <MathTransformer Absolute="true"/> </Transformer> </Binding> <Binding Target="[Adder.AddInt]" Source="[PanWidth.Value]"> <Transformer> <MathTransformer Absolute="true"/> </Transformer> </Binding> <Changed Source="[PanWidth.Value]"> <Conditions> <Equality Source="[Model.ScrollsColumns]" Value="false"/> <Equality Source="[PanWidth.Value]" ConditionOp="NotEquals" Value="0"/> </Conditions> <Actions> <Set Target="[Model.ChildLayoutInput!AnchorLayoutInput.Left.Offset]" Value="[InitialOffset]" Transformer="[Adder]" ExclusiveApply="false"/> <Invoke Target="[Background.MarkLayoutInvalid]" InvokePolicy="Synchronous"/> </Actions> </Changed> <Changed Source="[PanWidth.Value]"> <Conditions> <Equality Source="[Model.StartColumn]" ConditionOp="LessThan" Value="[Model.FirstVisibleTableColumn]"/> <Equality Source="[Model.EndColumn]" ConditionOp="GreaterThan" Value="[Model.FirstVisibleTableColumn]"/> <Equality Source="[PanWidth.Value]" ConditionOp="GreaterThan" Value="0"/> <Equality Source="[Model.DataSet.ColumnScrollData.CanScrollUp]" Value="true"/> </Conditions> <Actions> <Set Target="[Model.ChildLayoutInput!AnchorLayoutInput.Left.Offset]" Value="[InitialOffset]" Transformer="[Subtracter]" ExclusiveApply="false"/> <Invoke Target="[Background.MarkLayoutInvalid]" InvokePolicy="Synchronous"/> </Actions> </Changed> <Changed Source="[PanWidth.Value]"> <Conditions> <Equality Source="[Model.StartColumn]" ConditionOp="LessThanOrEquals" Value="[Model.FirstVisibleTableColumn]"/> <Equality Source="[Model.VisibleColumnSpan]" ConditionOp="GreaterThan" Value="[Model.DataSet.ColumnScrollData.ScrollIncrement]"/> <Equality Source="[PanWidth.Value]" ConditionOp="LessThan" Value="0"/> <Equality Source="[Model.DataSet.ColumnScrollData.CanScrollUp]" Value="true"/> </Conditions> <Actions> <Set Target="[Model.ChildLayoutInput!AnchorLayoutInput.Left.Offset]" Value="[InitialOffset]" Transformer="[Adder]" ExclusiveApply="false"/> <Invoke Target="[Background.MarkLayoutInvalid]" InvokePolicy="Synchronous"/> </Actions> </Changed> <Changed Source="[PanWidth.Value]"> <Conditions> <Equality Source="[Model.EndColumn]" ConditionOp="GreaterThan" Value="[Model.LastVisibleColumn]"/> <Equality Source="[PanWidth.Value]" ConditionOp="LessThan" Value="0"/> <Equality Source="[Model.DataSet.ColumnScrollData.CanScrollDown]" Value="true"/> </Conditions> <Actions> <Set Target="[Model.ChildLayoutInput!AnchorLayoutInput.Right.Offset]" Value="[InitialOffset]" Transformer="[Adder]" ExclusiveApply="false"/> <Invoke Target="[Background.MarkLayoutInvalid]" InvokePolicy="Synchronous"/> </Actions> </Changed> <Changed Source="[PanWidth.Value]"> <Conditions> <Equality Source="[PanWidth.Value]" Value="0"/> </Conditions> <Actions> <Set Target="[Model.ChildLayoutInput!AnchorLayoutInput.Right.Offset]" Value="[InitialOffset]" ExclusiveApply="false"/> <Set Target="[Model.ChildLayoutInput!AnchorLayoutInput.Left.Offset]" Value="[InitialOffset]" ExclusiveApply="false"/> <Invoke Target="[Background.MarkLayoutInvalid]" InvokePolicy="Synchronous"/> </Actions> </Changed> <Binding Target="[Input.Enabled]" Source="[Model.IsOnscreen]"/> <Changed Source="[Input.DeepKeyFocus]"> <Actions> <Invoke Target="[Model.OnFocusChanged]" focus="[Input.DeepKeyFocus]"/> </Actions> </Changed> <Condition Source="[Input.DeepKeyFocus]" ConditionOp="ChangedTo" SourceValue="true"> <Conditions> <Equality Source="[FocusArea.Value]" ConditionOp="Equals" Value="TurboScroll"/> </Conditions> <Actions> <Set Target="[FocusArea.Value]" Value="TurboScroll"/> </Actions> </Condition> <Condition Source="[Input.DeepKeyFocus]" ConditionOp="ChangedTo" SourceValue="true"> <Conditions> <Equality Source="[Model.Cell.StartRow]" Value="[ColumnHeaderRow]"/> </Conditions> <Actions> <Set Target="[FocusArea.Value]" Value="ColumnHeader"/> </Actions> </Condition> <Condition Source="[Input.DeepKeyFocus]" ConditionOp="ChangedTo" SourceValue="true"> <Conditions> <Equality Source="[Model.Cell.StartColumn]" Value="[RowHeaderColumn]"/> </Conditions> <Actions> <Set Target="[FocusArea.Value]" Value="RowHeader"/> </Actions> </Condition> <Condition Source="[Input.DeepKeyFocus]" ConditionOp="ChangedTo" SourceValue="true"> <Conditions> <Equality Source="[Model.Cell.StartColumn]" ConditionOp="NotEquals" Value="[RowHeaderColumn]"/> <Equality Source="[Model.Cell.StartRow]" ConditionOp="NotEquals" Value="[ColumnHeaderRow]"/> </Conditions> <Actions> <Set Target="[FocusArea.Value]" Value="TableBody"/> </Actions> </Condition> <Condition Source="[Input.DeepKeyFocus]" ConditionOp="ChangedTo" SourceValue="true"> <Conditions> <Equality Source="[Model.Cell.StartColumn]" Value="[RowHeaderColumn]"/> <Equality Source="[Model.Cell.StartRow]" Value="[ColumnHeaderRow]"/> </Conditions> <Actions> <Set Target="[FocusArea.Value]" Value="Corner"/> </Actions> </Condition> <Changed Source="[Model.KeyFocusRequested]"> <Actions> <Invoke Target="[Background.NavigateInto]"/> </Actions> </Changed> <Condition Source="[Input.DeepKeyFocus]" ConditionOp="ChangedTo" SourceValue="true"> <Actions> <PlaySound Sound="res://ehres!Focus_a.wav"/> </Actions> </Condition> <Changed Source="[WheelHandler.UpInvoked]"> <Actions> <Invoke Target="[Model.DataSet.ScrollBy]" row="-1" column="0"/> </Actions> </Changed> <Changed Source="[WheelHandler.DownInvoked]"> <Actions> <Invoke Target="[Model.DataSet.ScrollBy]" row="1" column="0"/> </Actions> </Changed> </Rules> <Content> <Panel Name="Background"/> </Content> </UI> </Mcml>